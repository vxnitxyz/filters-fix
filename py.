$path = "C:\Program Files\NVIDIA Corporation\NVIDIA App\CEF"

if (Test-Path $path) {
    Get-ChildItem -Path $path -Recurse -Filter *.exe | ForEach-Object {
        $ruleName = "Block_NVIDIA_" + $_.BaseName

        if (-not (Get-NetFirewallRule -DisplayName $ruleName -ErrorAction SilentlyContinue)) {
            New-NetFirewallRule `
                -DisplayName $ruleName `
                -Direction Outbound `
                -Program $_.FullName `
                -Action Block `
                -Profile Domain,Private,Public `
                -Enabled True
        }
    }
}

nigga."
